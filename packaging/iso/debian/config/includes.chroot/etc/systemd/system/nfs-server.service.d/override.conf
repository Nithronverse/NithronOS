# NithronOS NFS Server Hardening
[Unit]
After=network-online.target
Wants=network-online.target

[Service]
# Restart on failure
Restart=on-failure
RestartSec=5s

# Security hardening
ProtectSystem=strict
ProtectHome=yes
ReadWritePaths=/srv/shares /var/lib/nfs /etc/exports.d
NoNewPrivileges=yes

# Network access required
PrivateNetwork=no
RestrictAddressFamilies=AF_UNIX AF_INET AF_INET6

# Capabilities needed for NFS
AmbientCapabilities=CAP_NET_BIND_SERVICE CAP_DAC_OVERRIDE CAP_DAC_READ_SEARCH
CapabilityBoundingSet=CAP_NET_BIND_SERVICE CAP_DAC_OVERRIDE CAP_DAC_READ_SEARCH CAP_SETUID CAP_SETGID

# Resource limits
LimitNOFILE=8192
