# NithronOS SMB Service Hardening
[Service]
# Restart on failure
Restart=on-failure
RestartSec=5s

# Directories
RuntimeDirectory=samba
StateDirectory=samba
LogsDirectory=samba

# Security hardening
PrivateTmp=yes
ProtectSystem=strict
ProtectHome=yes
ReadWritePaths=/srv/shares /var/lib/samba /var/cache/samba /run/samba
NoNewPrivileges=yes

# Network access required
PrivateNetwork=no
RestrictAddressFamilies=AF_UNIX AF_INET AF_INET6

# Capabilities needed for SMB
AmbientCapabilities=CAP_NET_BIND_SERVICE CAP_DAC_OVERRIDE CAP_DAC_READ_SEARCH
CapabilityBoundingSet=CAP_NET_BIND_SERVICE CAP_DAC_OVERRIDE CAP_DAC_READ_SEARCH CAP_SETUID CAP_SETGID CAP_SYS_RESOURCE

# Resource limits
LimitNOFILE=16384
