#!/bin/bash
set -e

case "$1" in
    remove|upgrade|deconfigure)
        # Reload services gracefully before removal
        if [ -d /run/systemd/system ]; then
            # Export all NFS shares before stopping
            exportfs -ua 2>/dev/null || true
            
            # Reload services to pick up any final changes
            systemctl reload smbd.service 2>/dev/null || true
            systemctl reload nfs-server.service 2>/dev/null || true
        fi
        ;;
        
    failed-upgrade)
        ;;
        
    *)
        echo "prerm called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

#DEBHELPER#

exit 0
