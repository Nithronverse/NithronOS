#!/usr/bin/make -f

export DH_VERBOSE=1
export DEB_BUILD_MAINT_OPTIONS=hardening=+all

%:
	dh $@

override_dh_auto_build:
	GO111MODULE=on CGO_ENABLED=0 go build -o build/nos-agent ./agent/nos-agent

override_dh_auto_install:
	mkdir -p debian/nos-agent/usr/sbin
	mkdir -p debian/nos-agent/etc/systemd/system
	cp build/nos-agent debian/nos-agent/usr/sbin/nos-agent
	cp ../../../deploy/systemd/nos-agent.service debian/nos-agent/etc/systemd/system/nos-agent.service

override_dh_systemd_enable:
	dh_systemd_enable --name=nos-agent nos-agent.service


